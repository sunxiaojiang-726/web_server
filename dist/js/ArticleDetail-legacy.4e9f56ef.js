"use strict";(self["webpackChunkhmtt"]=self["webpackChunkhmtt"]||[]).push([[707],{33:function(t,e,n){n.r(e),n.d(e,{default:function(){return x}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-nav-bar",{attrs:{fixed:"",title:"文章详情","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),void 0===t.artObj.title?n("van-loading",{attrs:{type:"spinner",color:"#1989fa"}},[t._v(" 文章疯狂加载ing... ")]):n("div",[n("div",{staticClass:"article-container"},[n("h1",{staticClass:"art-title"},[t._v(t._s(t.artObj.title))]),n("van-cell",{attrs:{center:"",title:t.artObj.aut_name,label:t.formatDate(t.artObj.pubdate)},scopedSlots:t._u([{key:"icon",fn:function(){return[n("img",{staticClass:"avatar",attrs:{src:t.artObj.aut_photo,alt:""}})]},proxy:!0},{key:"default",fn:function(){return[n("div",[!0===t.artObj.is_followed?n("van-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.followedFn(!0)}}},[t._v("已关注")]):n("van-button",{attrs:{icon:"plus",type:"info",size:"mini",plain:""},on:{click:function(e){return t.followedFn(!1)}}},[t._v("关注")])],1)]},proxy:!0}])}),n("van-divider"),n("div",{staticClass:"art-content",domProps:{innerHTML:t._s(t.artObj.content)}}),n("van-divider",[t._v("End")]),n("div",{staticClass:"like-box"},[1===t.artObj.attitude?n("van-button",{attrs:{icon:"good-job",type:"danger",size:"small"},on:{click:function(e){return t.loveFn(!0)}}},[t._v("已点赞")]):n("van-button",{attrs:{icon:"good-job-o",type:"danger",plain:"",size:"small"},on:{click:function(e){return t.loveFn(!1)}}},[t._v("点赞")])],1)],1),n("div",[n("CommentList")],1)])],1)},r=[],o=n(6198),i=(n(5666),n(2502)),s=n(3842),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"cmt-list",class:{"art-cmt-container-1":t.isShowCmtBox,"art-cmt-container-2":!t.isShowCmtBox}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论了，请发表评论",offset:"50","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.commentsArr,(function(e){return n("div",{key:e.com_id,staticClass:"cmt-item"},[n("div",{staticClass:"cmt-header"},[n("div",{staticClass:"cmt-header-left"},[n("img",{staticClass:"avatar",attrs:{src:e.aut_photo,alt:""}}),n("span",{staticClass:"uname"},[t._v(t._s(e.aut_name))])]),n("div",{staticClass:"cmt-header-right"},[!0===e.is_liking?n("van-icon",{attrs:{name:"like",size:"16",color:"red"},on:{click:function(n){return t.likeFn(!0,e)}}}):n("van-icon",{attrs:{name:"like-o",size:"16",color:"gray"},on:{click:function(n){return t.likeFn(!1,e)}}})],1)]),n("div",{staticClass:"cmt-body"},[t._v(" "+t._s(e.content)+" ")]),n("div",{staticClass:"cmt-footer"},[t._v(t._s(t.formatDate(e.pubdate)))])])})),0)],1),n("div",[!0===t.isShowCmtBox?n("div",{staticClass:"add-cmt-box van-hairline--top"},[n("van-icon",{attrs:{name:"arrow-left",size:"0.48rem"},on:{click:function(e){return t.$router.back()}}}),n("div",{staticClass:"ipt-cmt-div",on:{click:t.toggleShowFn}},[t._v("发表评论")]),n("div",{staticClass:"icon-box"},[n("van-badge",{attrs:{content:0===t.totalCount?"":t.totalCount,max:"50"}},[n("van-icon",{attrs:{name:"comment-o",size:"0.53333334rem"},on:{click:t.commentClickFn}})],1),n("van-icon",{attrs:{name:"star-o",size:"0.53333334rem"}}),n("van-icon",{attrs:{name:"share-o",size:"0.53333334rem"}})],1)],1):n("div",{staticClass:"cmt-box van-hairline--top"},[n("textarea",{directives:[{name:"fofo",rawName:"v-fofo"},{name:"model",rawName:"v-model.trim",value:t.comText,expression:"comText",modifiers:{trim:!0}}],attrs:{placeholder:"友善评论、理性发言、阳光心灵"},domProps:{value:t.comText},on:{blur:[t.blurFn,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.comText=e.target.value.trim())}}}),n("van-button",{attrs:{type:"default",disabled:0===t.comText.length},on:{click:t.sendFn}},[t._v("发布")])],1)])])},l=[],u=n(4479),d=(n(2222),{data:function(){return{offset:null,commentsArr:[],isShowCmtBox:!0,totalCount:0,comText:"",loading:!1,finished:!1,lastId:null}},created:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.fN)({id:t.$route.query.art_id});case 2:n=e.sent,console.log(n,"评论列表"),t.commentsArr=n.data.data.results,t.totalCount=n.data.data.total_count,t.lastId=n.data.data.last_id,0===n.data.data.results.length&&(t.finished=!0);case 8:case"end":return e.stop()}}),e)})))()},methods:{formatDate:s.S,likeFn:function(t,e){return(0,o.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!0!==t){n.next=8;break}return e.is_liking=!1,n.next=4,(0,i.PI)({comId:e.com_id});case 4:a=n.sent,console.log(a,"取消评论点赞"),n.next=13;break;case 8:return e.is_liking=!0,n.next=11,(0,i.Yf)({comId:e.com_id});case 11:r=n.sent,console.log(r,"评论点赞");case 13:case"end":return n.stop()}}),n)})))()},toggleShowFn:function(){this.isShowCmtBox=!1},commentClickFn:function(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},sendFn:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.ge)({id:t.$route.query.art_id,content:t.comText});case 2:n=e.sent,console.log(new Date),console.log(n,"发布评论"),t.commentsArr.unshift(n.data.data.new_obj),t.totalCount++,t.comText="",t.commentClickFn();case 9:case"end":return e.stop()}}),e)})))()},blurFn:function(){var t=this;setTimeout((function(){t.isShowCmtBox=!0}),0)},onLoad:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.commentsArr.length>0)){e.next=12;break}return e.next=3,(0,i.fN)({id:t.$route.query.art_id,offset:t.lastId});case 3:n=e.sent,console.log(n,"评论列表"),t.commentsArr=[].concat((0,u.Z)(t.commentsArr),(0,u.Z)(n.data.data.results)),t.totalCount=n.data.data.total_count,t.lastId=n.data.data.last_id,null===n.data.data.last_id&&(t.finished=!0),t.loading=!1,e.next=13;break;case 12:t.loading=!1;case 13:case"end":return e.stop()}}),e)})))()}}}),m=d,f=n(1001),v=(0,f.Z)(m,c,l,!1,null,"07953acc",null),h=v.exports,g={name:"Detail",data:function(){return{artObj:{}}},created:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.xu)({artId:t.$route.query.art_id});case 2:n=e.sent,console.log(n,"文章详情"),t.artObj=n.data.data;case 5:case"end":return e.stop()}}),e)})))()},methods:{formatDate:s.S,followedFn:function(t){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!0!==t){n.next=8;break}return e.artObj.is_followed=!1,n.next=4,(0,i.ij)({userId:e.artObj.aut_id});case 4:a=n.sent,console.log(a,"取关作者"),n.next=13;break;case 8:return e.artObj.is_followed=!0,n.next=11,(0,i.ty)({userId:e.artObj.aut_id});case 11:r=n.sent,console.log(r,"关注作者");case 13:case"end":return n.stop()}}),n)})))()},loveFn:function(t){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!0!==t){n.next=8;break}return e.artObj.attitude=0,n.next=4,(0,i.HB)({artId:e.artObj.art_id});case 4:a=n.sent,console.log(a,"取消文章点赞"),n.next=13;break;case 8:return e.artObj.attitude=1,n.next=11,(0,i.DO)({artId:e.artObj.art_id});case 11:r=n.sent,console.log(r,"文章点赞");case 13:case"end":return n.stop()}}),n)})))()}},components:{CommentList:h}},p=g,b=(0,f.Z)(p,a,r,!1,null,"0850d428",null),x=b.exports}}]);
//# sourceMappingURL=ArticleDetail-legacy.4e9f56ef.js.map